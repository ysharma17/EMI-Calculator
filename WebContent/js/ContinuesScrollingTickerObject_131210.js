
/************************************
* Developed by Illimar Pihlamäe		*
* e-mail: illimar@idra.pri.ee		*
* Euroland Estonia © 2012			*
* e-mail: illimar@euroland.com		*
*************************************/

var ScrollingTickerObject=function(){var This=this;this.dom=document.createElement('div');	this.styleContainer=document.createElement('div');	this.container=document.createElement('div');	this.containersContainer=document.createElement('div');	this.scrollingWidth=0;	this.jump=1;	this.sysJump=0;	this.speed=24;this.scrollFromRight=true;	this.hasLoaded=false;	this.isRTL=false;this.InstrumentsSettings=[];	this.spaceBetweenScrollers=100;this.scrollingType=0;	this.status=0;	this.isData=false;	this.isVisibleOnInitialLoad=false;this.Scrollers=[];this.fadingEdgeBackground='';this.sysLoad=function(){if(typeof this.instrumentSeparator!='string'){this.instrumentSeparator=" | ";}};this.load=function(){if(typeof this.scrollingWidth!='number'||this.width < 1){this.scrollingWidth=0;}this.dom.className='ScrollerMainContainer';this.styleContainer.className='ScrollerContainer';document.body.style.padding=this.container.style.padding=this.container.style.margin=this.container.style.border=this.containersContainer.style.margin=this.containersContainer.style.padding=this.containersContainer.style.border='0px';this.dom.appendChild(this.styleContainer);this.styleContainer.appendChild(this.containersContainer);this.containersContainer.appendChild(this.container);if(this.scrollingWidth < 1){this.scrollingWidth=parseFloat(this.containersContainer.offsetWidth);}this.containersContainer.style.width=this.container.style.width=this.scrollingWidth+'px';this.containersContainer.style.position='absolute';this.containersContainer.style.top='auto';this.containersContainer.style.left='auto';this.containersContainer.style.overflow='hidden';this.containersContainer.style.zIndex='10';this.container.style.zIndex='100';this.container.style.overflow='hidden';this.container.style.whiteSpace='nowrap';this.container.style.direction='ltr';this.addScroller(true);switch(this.scrollingType){case 0:this.spaceBetweenScrollers=this.scrollingWidth;break;case 1:this.spaceBetweenScrollers=this.scrollingWidth-parseFloat(this.Scrollers[0].dom.offsetWidth);if(this.spaceBetweenScrollers < 0)this.spaceBetweenScrollers=0;break;}if(typeof this.jump=='number'){this.jump=Math.floor(this.jump);if(this.jump < 1)this.jump=1;}else{this.jump=1;}if(typeof this.speed!='number'||this.speed < 1)this.speed=1;this.jump=this.speed/Graphics._fps;this.isData=this.showOnlyData();if(this.isData){this.x=0;this.status=0;this.containersContainer.style.overflow='visible';this.container.style.overflow='visible';this.Scrollers[0].dom.style.visibility='visible';return;}if(this.scrollingType==2&&this.isVisibleOnInitialLoad){var index,width;width=parseFloat(this.Scrollers[0].dom.offsetWidth);if(this.scrollingWidth > width&&width > 0){index=Math.ceil((this.scrollingWidth-width)/width);while(index--){this.addScroller(true);}}checkVisibility();}this.dom.onmouseover=function(){This.onMouseOver();};this.dom.onmouseout=function(){This.onMouseOff();};this.dom.onclick=function(){This.onMouseClick();};this.status=1;	if(typeof this.fadingEdgeBackground!='string'||!this.fadingEdgeBackground.length)return;this.styleContainer.style.background=this.fadingEdgeBackground;var stylePos=Graphics.Obj.xy(this.styleContainer),containerPos=Graphics.Obj.pos(this.containersContainer),alpha,dom,offset,height=parseFloat(this.styleContainer.clientHeight),y=stylePos.y+parseFloat(this.styleContainer.clientTop);	for(alpha=1,offset=0;offset < 10;alpha-=0.1,offset++){this.dom.appendChild(getFadingEdgeSegment(containerPos.x+offset,y,height,alpha));this.dom.appendChild(getFadingEdgeSegment(containerPos.x+containerPos.width-offset-1,y,height,alpha));}};function getFadingEdgeSegment(x,y,height,alpha){var dom=document.createElement('div');dom.style.background=This.fadingEdgeBackground;dom.style.position='absolute';dom.style.width='1px';dom.style.height=height+'px';dom.style.left=x+'px';dom.style.top=y+'px';dom.style.zIndex='110';if(Page.IE7_8){var opacity=Math.floor(alpha*100);if(opacity < 0)opacity=0;else if(opacity > 100)opacity=100;	dom.style.filter='progid:DXImageTransform.Microsoft.Alpha(Opacity='+opacity+')';}else{dom.style.opacity=alpha;}return dom;}this.addScroller=function(isInitialLoad){var obj={dom:document.createElement('div'),Instruments:[],zeroPosition:0,x:0,isVisible:true,hasFired:false,	movedAmount:0},i,temp;obj.dom.style.margin='0px';obj.dom.style.zIndex='1000';obj.dom.style.position='relative';obj.dom.style.whiteSpace='nowrap';obj.dom.style.visibility='hidden';if(Page.IE6_7){obj.dom.style.zoom=1.0;obj.dom.style.display='inline';}else{obj.dom.style.display='inline-block';}if(this.isRTL){obj.dom.style.direction='rtl';}this.container.appendChild(obj.dom);for(i=0;i < this.InstrumentsSettings.length;i++){obj.Instruments.push(new ScrollingTickerInstrumentObject(this.InstrumentsSettings[i],true,this.Scrollers.length));if(i){obj.dom.appendChild(document.createTextNode(this.instrumentSeparator));}temp=obj.Instruments[i];temp.index=i;obj.dom.appendChild(temp.dom);temp.loadedCall=function(instrument){This.instrumentLoaded(instrument);};}this.styleContainer.style.height=parseFloat(obj.dom.offsetHeight)+'px';this.Scrollers.push(obj);	temp=parseFloat(this.Scrollers[0].dom.offsetWidth);i=this.Scrollers.length;if(this.scrollFromRight){while(i--){this.Scrollers[i].zeroPosition=this.scrollingWidth-(i*temp);}}else{while(i--){this.Scrollers[i].zeroPosition=-((i+1)*temp);}}if(isInitialLoad&&this.isVisibleOnInitialLoad){if(this.scrollFromRight){obj.x=this.scrollingWidth-obj.zeroPosition;}else{obj.x=0-obj.zeroPosition;}obj.movedAmount=Math.abs(obj.x-obj.zeroPosition);obj.hasFired=true;}else{obj.x=obj.zeroPosition;}	obj=this.Scrollers[0].Instruments;if(this.Scrollers.length==1){i=obj.length;while(i--){obj[i].load();}return;}i=obj.length;while(i--){this.unifyInstruments(obj[i]);}};this.showOnlyData=function(){var arr=location.href.split('?',2),temp,index;if(arr.length!=2)return false;arr=arr[1].split('&');index=arr.length;while(index--){temp=arr[index].split('=',2);if(temp[0].toLowerCase()=='data'){temp=temp[1].toLowerCase();return(temp=="1"||temp=='true');}}return false;};this.unifyInstruments=function(instrument){var i,j,scrollerObj,objA,objB;i=this.Scrollers.length;while(0 <--i){scrollerObj=this.Scrollers[i].Instruments[instrument.index];j=instrument.Values.length;while(j--){objA=instrument.Values[j];objB=scrollerObj.Values[j];objB.dom.className=objA.dom.className;if(typeof objA.originalClass=='string')continue;objB.dom.removeChild(objB.value);objB.strValue=objA.strValue;objB.value=document.createTextNode(objB.strValue);objB.dom.appendChild(objB.value);}}};function checkVisibility(){var index=This.Scrollers.length,obj;while(index--){obj=This.Scrollers[index];if(obj.isVisible&&(obj.movedAmount > This.scrollingWidth||obj.movedAmount < 0)){obj.isVisible=false;obj.x=obj.zeroPosition;obj.dom.style.visibility='hidden';}}}this.instrumentLoaded=function(instrument){if(this.scrollingType==1){this.spaceBetweenScrollers=this.scrollingWidth-parseFloat(this.Scrollers[0].dom.offsetWidth);if(this.spaceBetweenScrollers < 0)this.spaceBetweenScrollers=0;}if(instrument){this.unifyInstruments(instrument);}if(this.isData)return;var status=this.status,obj,index,movedAmount,arr=[],width=parseFloat(this.Scrollers[0].dom.offsetWidth);	this.status=2;index=this.Scrollers.length;while(index--){obj=this.Scrollers[index];if(this.scrollFromRight)obj.zeroPosition=this.scrollingWidth-(width*index);else	obj.zeroPosition=-((index+1)*width);if(obj.isVisible)arr.push(obj);else	obj.x=obj.zeroPosition;}arr.sort(function(a,b){return b.movedAmount-a.movedAmount;});if(!arr.length){this.status=status;return;}obj=arr[0];obj.hasFired=false;movedAmount=obj.movedAmount;obj.x=this.scrollFromRight ? obj.zeroPosition-obj.movedAmount:obj.zeroPosition+obj.movedAmount;obj.dom.style.left=obj.x+'px';for(index=1;index < arr.length;index++){obj=arr[index];obj.hasFired=false;movedAmount-=width+this.spaceBetweenScrollers;obj.movedAmount=movedAmount;obj.x=this.scrollFromRight ? obj.zeroPosition-obj.movedAmount:obj.zeroPosition+obj.movedAmount;if(obj.movedAmount > 0&&obj.movedAmount < width+this.scrollingWidth){obj.dom.style.left=obj.x+'px';continue;}obj.isVisible=false;obj.x=obj.zeroPosition;obj.dom.style.visibility='hidden';}for(index=0;index < arr.length;index++){obj=arr[index];if(!obj.isVisible)continue;if(index+1 < arr.length){if(arr[index+1].isVisible)obj.hasFired=true;}}this.status=status;};this.frameCall=function(){if(this.status!=1)return;this.sysJump+=this.jump;if(Math.floor(this.sysJump)< 1)return;var jump=Math.floor(this.sysJump),obj,index,width,temp,addNewScroller=false;this.sysJump=0;if(this.scrollFromRight)jump=-jump;index=this.Scrollers.length;while(index--){obj=this.Scrollers[index];if(!obj.isVisible)continue;obj.x+=jump;obj.dom.style.left=obj.x+'px';obj.dom.style.visibility='visible';width=parseFloat(obj.dom.offsetWidth);obj.movedAmount=Math.abs(obj.x-obj.zeroPosition);if(!obj.hasFired&&obj.movedAmount >=width+this.spaceBetweenScrollers){addNewScroller=true;obj.hasFired=true;}if(obj.movedAmount < width+this.scrollingWidth)continue;obj.isVisible=false;obj.hasFired=false;obj.x=obj.zeroPosition;obj.dom.style.visibility='hidden';if(this.Scrollers.length==1)addNewScroller=true;}if(!addNewScroller)return;for(index=0;index < this.Scrollers.length;index++){obj=this.Scrollers[index];if(!obj.isVisible){obj.isVisible=true;return;}}this.addScroller();};this.onMouseOver=function(){if(this.status==2)return;this.status=0;};this.onMouseOff=function(){if(this.status==2)return;this.status=1;};this.onMouseClick=function(){this.status=this.status==2 ? 1:2;};this.copyObject=function(obj){var name,ret=new Object();for(name in obj){switch(typeof obj[name]){case 'object':if(obj[name]==null){ret[name]==null;break;}ret[name]=this.copyObject(obj[name]);break;default:ret[name]=obj[name];break;}}return ret;};this.sysLoad();};